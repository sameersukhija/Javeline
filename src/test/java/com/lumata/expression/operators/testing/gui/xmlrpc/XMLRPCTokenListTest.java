package com.lumata.expression.operators.testing.gui.xmlrpc;

import org.testng.Assert;
import org.testng.annotations.Test;

import com.lumata.expression.operators.gui.xmlrpc.XMLRPCTokenList;
import com.lumata.expression.operators.gui.xmlrpc.XMLRPCTokenList.Token;

public class XMLRPCTokenListTest {

	@Test
	public void testResponse() {
		try {
			String responseText = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><methodResponse><params><param><value><tokens xmlns:off=\"com/act750/xmlrpc/offerOptimizer\"><token><msisdn>3399900001</msisdn><code>gl-376ed</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-3effc</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-5cebb</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-76cf9</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-8c49c</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-937ed</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-b68f0</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-d811b</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-e364d</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-e9fee</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-ee5bd</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-eeff5</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-f70bc</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-fc278</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token><token><msisdn>3399900001</msisdn><code>gl-feddd</code><label>TokenA</label><status>active</status><sent_date>2013-04-14T02:59+0000</sent_date><expiry_date>2013-07-23T02:59+0000</expiry_date><consumed_date/><requestor><id>2</id><name>OfferOptimizerTest</name><description>OfferOptimizerTest</description><type>campaign</type></requestor><is_already_allocated>false</is_already_allocated><description/><image_url/></token></tokens></value></param></params></methodResponse>";
			XMLRPCTokenList xmlrpcToken = new XMLRPCTokenList(responseText).parse();
			Assert.assertEquals(xmlrpcToken.getTokenNumber(), 15);
			for (Token token : xmlrpcToken.getTokenList()) {
				Assert.assertNotNull(token);
				Assert.assertEquals(token.getMsisdn(),"3399900001");
				Assert.assertNotNull(token.getCode());
				Assert.assertNotNull(token.getSentDate());
				Assert.assertNotNull(token.getExpiryDate());
				Assert.assertEquals(token.getStatus(),"active");
				Assert.assertEquals(token.getConsumedDate(),"");
				Assert.assertEquals(token.getIsAlreadyAllocated(),"false");
				Assert.assertNotNull(token.getRequestor());
				Assert.assertEquals(token.getRequestor().getId(),"2");
				Assert.assertEquals(token.getRequestor().getName(),"OfferOptimizerTest");
				Assert.assertEquals(token.getRequestor().getDescription(),"OfferOptimizerTest");
				Assert.assertEquals(token.getRequestor().getType(),"campaign");
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}

