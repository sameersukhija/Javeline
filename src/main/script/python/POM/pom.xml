<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>

	<!-- This pom has been autogenerated via maven archetypes. Please refer 
		to: https://kb.lumata.com/display/SOGFT/BundledMavenArchetypes for relevant 
		documentation. You can also refer to accompanying README files within distribution 
		directories under src/main for a quick reference. Please remember to remove 
		all uneeded directories under src/main before committing a new environment 
		to source code repository. -->

	<parent>
		<groupId>com.lumata.so.gft.bundles.expression</groupId>
		<artifactId>expression-env-base</artifactId>
		<version>2.4.1.12.3</version>
	</parent>

	<properties>
		<!-- Complete list of properties available in com.lumata.so.gft.bundles.expression:expression-delivery:${parent.version}:pom -->
		<my.businessline>expression</my.businessline>
		<my.country>all</my.country>
		<!--my be void if multicountry -->
		<my.project>qa</my.project>
		<my.component>_qa</my.component>
		<!-- Complete properties list available within parent pom -->
	</properties>

	<groupId>com.lumata.expression.all</groupId>
	<artifactId>expression-all-qa-qa-expression</artifactId>

	<packaging>pom</packaging>
	<name>Expression installation for project qa (qa component)</name>
	<description>${my.businessline} ${my.country} ${my.project} ${my.component} expression</description>

	<!-- Your jar dependencies go here -->

	<dependencies>
		
		<dependency>
			<groupId>com.act750.component.custo</groupId>
			<artifactId>QADatabaseAdaptor</artifactId>
			<version>2.4.1.Pre-Release-SNAPSHOT</version>
		</dependency>

		<dependency>
			<groupId>com.act750.component.product</groupId>
			<artifactId>Documentation</artifactId>
			<version>%(Documentation)s</version>
			<type>war</type>
			<classifier>QADatabaseAdaptor</classifier>
		</dependency>

		<dependency>
			<groupId>com.lumata.expression</groupId>
			<artifactId>expression-database-structure</artifactId>
			<version>%(database-structure)s</version>
			<type>zip</type>
		</dependency>

		<dependency>
		    <groupId>com.act750.component.product</groupId>
		    <artifactId>actruleServer</artifactId>
		    <version>%(actruleServer)s</version>
		    <exclusions>
			<exclusion>
			    <groupId>com.google.gwt</groupId>
			    <artifactId>gwt-user</artifactId>
			</exclusion>
			<exclusion>
			    <groupId>org.jboss.resteasy</groupId>
			    <artifactId>resteasy-jaxrs</artifactId>
			</exclusion>
		    </exclusions>
		</dependency>

		<dependency>
		    <groupId>com.act750.component.product</groupId>
		    <artifactId>actruleClient</artifactId>
		    <version>%(actruleClient)s</version>
		    <type>war</type>
		    <scope>compile</scope>
		    <exclusions>
			<exclusion>
			    <groupId>com.google.gwt</groupId>
			    <artifactId>gwt-dev</artifactId>
			</exclusion>
		    </exclusions>
		</dependency>

		<dependency>
		    <groupId>com.act750.component.product</groupId>
		    <artifactId>actruleClient</artifactId>
		    <version>%(actruleClient)s</version>
		    <classifier>classes</classifier>
		    <scope>compile</scope>
		    <exclusions>
			<exclusion>
			    <groupId>com.google.gwt</groupId>
			    <artifactId>gwt-dev</artifactId>
			</exclusion>
		    </exclusions>
		</dependency>

		<dependency>
			<groupId>com.act750.component.product</groupId>
			<artifactId>eventStorage</artifactId>
			<version>%(eventStorage)s</version>
		</dependency>

		<dependency>
			<groupId>com.act750.component.product</groupId>
			<artifactId>actruleFramework</artifactId>
			<version>%(actruleFramework)s</version>
		</dependency>

		<dependency>
			<groupId>com.act750.component.product</groupId>
			<artifactId>databaseAdaptor</artifactId>
			<version>%(databaseAdaptor)s</version>
		</dependency>
		
		<dependency>
			<groupId>com.act750.component.product</groupId>
			<artifactId>StatsManager</artifactId>
			<version>%(StatsManager)s</version>
		</dependency>
		
		<dependency>
		    <groupId>net.zschech</groupId>
		    <artifactId>gwt-comet</artifactId>
		    <version>1.2.5</version>
		</dependency>
		<dependency>
		    <groupId>com.google.gwt</groupId>
		    <artifactId>gwt-servlet</artifactId>
		    <version>2.5.1</version>
		</dependency>
		<dependency>
		    <groupId>com.smartgwt</groupId>
		    <artifactId>smartgwt</artifactId>
		    <version>4.0</version>
		</dependency>

	</dependencies>

	<profiles>
		<profile>
			<properties>
				<expression.local.home.path>/usr/local/actrule</expression.local.home.path>
			</properties>
			<activation>
				<property>
					<name>local</name>
					<value>true</value>
				</property>
			</activation>
			<build>
				<plugins>
					<plugin>
						<artifactId>maven-antrun-plugin</artifactId>
						<version>1.7</version>
						<executions>
							<execution>
								<id>stop-engine</id>
								<phase>install</phase>
								<configuration>
									<target>
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="if [ -f ${expression.local.home.path}/bin/expression.sh ]; then ${expression.local.home.path}/bin/expression.sh stop; fi" />
									</target>
								</configuration>
								<goals>
									<goal>run</goal>
								</goals>
							</execution>
							<execution>
								<id>clean-create-dir-structure</id>
								<phase>install</phase>
								<configuration>
									<target>
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root" command="rm -rf ${expression.local.home.path}" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root" command="mkdir -p ${expression.local.home.path}" />
									</target>
								</configuration>
								<goals>
									<goal>run</goal>
								</goals>
							</execution>
							<execution>
								<phase>install</phase>
								<configuration>
									<target>
										<scp
											todir="root:root@192.168.56.151:${expression.local.home.path}/"
											trust="true">
											<fileset dir="${project.build.directory}/expression" />
										</scp>
									</target>
								</configuration>
								<goals>
									<goal>run</goal>
								</goals>
							</execution>
							<execution>
								<id>create-logs-dir</id>
								<phase>install</phase>
								<configuration>
									<target>
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="mkdir -p ${expression.local.home.path}/logs" />
									</target>
								</configuration>
								<goals>
									<goal>run</goal>
								</goals>
							</execution>
							<execution>
								<id>modify-permissions</id>
								<phase>install</phase>
								<configuration>
									<target>
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="chmod ugo+rx ${expression.local.home.path}/bin/* ${expression.local.home.path}/scripts/* ${expression.local.home.path}/scripts/nms/*" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="chmod ugo+rx ${expression.local.home.path}/lib/libVersions/*.so*" />
									</target>
								</configuration>
								<goals>
									<goal>run</goal>
								</goals>
							</execution>
							<execution>
								<id>create-symlinks</id>
								<phase>install</phase>
								<configuration>
									<target>
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="ln -s ${expression.local.home.path}/lib/Documentation* ${expression.local.home.path}/lib/Documentation.war" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="ln -s ${expression.local.home.path}/lib/actruleFramework* ${expression.local.home.path}/lib/actruleFramework.jar" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="ln -s ${expression.local.home.path}/lib/log4j* ${expression.local.home.path}/lib/log4j.jar" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="ln -s ${expression.local.home.path}/lib/libVersions/jmaybe-0.7.4.jar ${expression.local.home.path}/lib/jmaybe.jar" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="ln -s ${expression.local.home.path}/lib/libVersions/libboost_serialization-gcc41-mt-1_34_1.so.1.34.1 ${expression.local.home.path}/lib/libboost_serialization-gcc41-mt-1_34_1.so.1.34.1" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="ln -s ${expression.local.home.path}/lib/libVersions/libjmaybe-0.7.4.so ${expression.local.home.path}/lib/libjmaybe.so" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="ln -s ${expression.local.home.path}/lib/libVersions/libspl.so ${expression.local.home.path}/lib/libspl.so" />
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="ln -s ${expression.local.home.path}/lib/libVersions/libtcc.so ${expression.local.home.path}/lib/libtcc.so" />
									</target>
								</configuration>
								<goals>
									<goal>run</goal>
								</goals>
							</execution>
							<execution>
								<id>start-engine</id>
								<phase>install</phase>
								<configuration>
									<target>
										<sshexec host="192.168.56.151" trust="yes" username="root"
											password="root"
											command="sh ${expression.local.home.path}/bin/expression.sh start" />
									</target>
								</configuration>
								<goals>
									<goal>run</goal>
								</goals>
							</execution>
						</executions>
						<dependencies>
							<dependency>
								<groupId>com.jcraft</groupId>
								<artifactId>jsch</artifactId>
								<version>0.1.50</version>
							</dependency>
							<dependency>
								<groupId>org.apache.ant</groupId>
								<artifactId>ant-jsch</artifactId>
								<version>1.9.2</version>
							</dependency>
						</dependencies>
					</plugin>
				</plugins>
			</build>
		</profile>
	</profiles>
</project>